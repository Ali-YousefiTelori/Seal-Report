function callbackHandler(e,t,n){e.error?n?n(e):(SWIUtil.ShowMessage("alert-danger",e.error,0),e.authenticated||location.reload(!0)):t&&t(e)}function failure(){SWIUtil.ShowMessage("alert-danger",_errorServer,0)}var SWIUtil;!function(e){function t(e){var t=translations[e];return t&&""!=t||(t=e),t}function n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}function o(e){return e.split("\\").pop().replace(".srex","")}function i(e){return e.substring(0,e.lastIndexOf("\\"))}function a(t,n,o){$waitDialog.modal("hide"),e.HideMessages();var i=$("<div class='alert' style='position:absolute; width:100%;z-index: 2000;margin-bottom:0;'><a href='#' class='close' data-dismiss='alert' aria-label='close'>&times;</a><p>"+n+"</p></div>");i.css("top",($(window).height()-54).toString()+"px"),i.addClass(t),$("body").append(i),0==o&&(o=15e3),o>0&&setTimeout(function(){i.alert("close")},o)}function r(){$(".alert").alert("close")}function l(e,t){t?e.removeProp("disabled").removeClass("disabled"):e.prop("disabled","true").addClass("disabled")}function p(e,t){t?e.removeAttr("disabled"):e.attr("disabled","true")}function d(e,t,n){n?(e.addClass("active"),t.show()):(e.removeClass("active"),t.hide())}function s(e,t){t?e.show():e.hide()}function c(e,t,n,o){var i=$("<option>").attr("value",e).html(t?t:e);return o&&i.attr("data-icon",o),e==n&&i.attr("selected","true"),i}e.tr=t,e.Newguid=n,e.GetReportName=o,e.GetDirectoryName=i,e.ShowMessage=a,e.HideMessages=r,e.EnableButton=l,e.EnableLinkInput=p,e.ActivatePanel=d,e.ShowHideControl=s,e.GetOption=c}(SWIUtil||(SWIUtil={}));var SWIButtonGroup=function(){function e(e,t){this.Group=$(".element-btn-group").first().clone().css("display","inline"),this.Button=this.Group.children(".element-btn"),this.PropButton=this.Group.children(".element-prop-btn"),this.Button.data("element",e),this.Element=e,this.Column=t,this.DropButton=this.Group.children(".dropdown-toggle")}return e.prototype.getDisplayValues=function(){var e="";if(this.Column.enums){var t=this.Column.enums;$.each(this.Element.evals,function(n,o){$.each(t,function(t,n){n.id==o&&(e+=(e?";":"")+n.val)})})}else this.Element.val1&&(e+=(e?";":"")+this.Element.val1),this.Element.val2&&(e+=(e?";":"")+this.Element.val2),this.Element.val3&&(e+=(e?";":"")+this.Element.val3),this.Element.val4&&(e+=(e?";":"")+this.Element.val4);return e?e:"?"},e.prototype.Redraw=function(){var e=this.Element;this.Button.css("width",10==e.position?"88%":"75%");var t="",n="";if(10==e.position){0==e.oper?t=SWIUtil.tr("Equals"):1==e.oper?t=SWIUtil.tr("Is different from"):2==e.oper?t=SWIUtil.tr("Is greater than"):3==e.oper?t=SWIUtil.tr("Is greater or equal than"):4==e.oper?t=SWIUtil.tr("Is smaller than"):5==e.oper?t=SWIUtil.tr("Is smaller or equal than"):6==e.oper?t=SWIUtil.tr("Is between"):7==e.oper?t=SWIUtil.tr("Is not between"):8==e.oper?t=SWIUtil.tr("Contains"):9==e.oper?t=SWIUtil.tr("Does not contain"):10==e.oper?t=SWIUtil.tr("Starts with"):11==e.oper?t=SWIUtil.tr("Ends with"):12==e.oper?t=SWIUtil.tr("Is empty"):13==e.oper?t=SWIUtil.tr("Is not empty"):14==e.oper?t=SWIUtil.tr("Is not Null"):15==e.oper&&(t=SWIUtil.tr("Is Null"));var o=!1,i=!1,a=!1,r=!1,l=!1;0==e.oper||1==e.oper?n=this.getDisplayValues():2==e.oper||3==e.oper||4==e.oper||5==e.oper?n=e.val1?e.val1:"?":6==e.oper||7==e.oper?n=(e.val1?e.val1:"?")+" and "+(e.val2?e.val2:"?"):10!=e.oper&&11!=e.oper||(n=e.val1?e.val1:"?");var o=!1,i=!1,a=!1,r=!1;2==e.oper||3==e.oper||4==e.oper||5==e.oper||10==e.oper||11==e.oper?(i=!0,a=!0,r=!0):6==e.oper||7==e.oper?(a=!0,r=!0):14!=e.oper&&15!=e.oper||(o=!0,i=!0,a=!0,r=!0,l=!0),SWIUtil.EnableLinkInput($("#property-val1"),!o),SWIUtil.EnableLinkInput($("#property-val2"),!i),SWIUtil.EnableLinkInput($("#property-val3"),!a),SWIUtil.EnableLinkInput($("#property-val4"),!r),$("#property-evals").multipleSelect(l?"disable":"enable")}this.Button.children("span").remove(),this.Button.append($("<span style='padding-left: 10px'>"+e.name+"</span>")),t&&this.Button.append($("<span><i><b> "+t+" </b></i></span>")),n&&this.Button.append($("<span> "+n+"</span>")),this.Button.children("i").remove();var p=null;1==e.position||2==e.position?2==e.serie?p="long-arrow-right":3==e.serie&&(p="fa-ellipsis-h"):3==e.position?0==e.chart?p="line-chart":1==e.chart?p="pie-chart":2==e.chart?p="line-chart":3==e.chart?p="bar-chart":4==e.chart?p="area-chart":5==e.chart&&(p="line-chart"):10==e.position&&0!=e.prompt&&(p="hand-o-right"),p&&this.Button.append($("<i style='position:absolute;left:5px;top:8px'>").addClass("fa fa-"+p))},e}(),_sealServer=WebApplicationName+("/"==WebApplicationName?"":"/"),_errorServer=SWIUtil.tr("Error: Unable to connect to the server")+": '"+_sealServer+"'",SWIGateway=function(){function e(){}return e.prototype.GetVersions=function(e,t){$.post(_sealServer+"SWIGetVersions",{}).done(function(n){callbackHandler(n,e,t)}).fail(function(){failure()})},e.prototype.Login=function(e,t,n,o){$.post(_sealServer+"SWILogin",{user:e,password:t}).done(function(e){callbackHandler(e,n,o)}).fail(function(){failure()})},e.prototype.Logout=function(e,t){$.post(_sealServer+"SWILogout").done(function(n){callbackHandler(n,e,t)}).fail(function(){failure()})},e.prototype.GetUserProfile=function(e,t){$.post(_sealServer+"SWIGetUserProfile").done(function(n){callbackHandler(n,e,t)}).fail(function(){failure()})},e.prototype.GetCultures=function(e,t){$.post(_sealServer+"SWIGetCultures").done(function(n){callbackHandler(n,e,t)}).fail(function(){failure()})},e.prototype.SetUserProfile=function(e,t,n){$.post(_sealServer+"SWISetUserProfile",{culture:e}).done(function(e){callbackHandler(e,t,n)}).fail(function(){failure()})},e.prototype.DeleteFiles=function(e,t,n){$.post(_sealServer+"SWIDeleteFiles",{paths:e}).done(function(e){callbackHandler(e,t,n)}).fail(function(){failure()})},e.prototype.MoveFile=function(e,t,n,o,i){$.post(_sealServer+"SWIMoveFile",{source:e,destination:t,copy:n}).done(function(e){callbackHandler(e,o,i)}).fail(function(){failure()})},e.prototype.GetRootFolders=function(e,t){$.post(_sealServer+"SWIGetRootFolders",{}).done(function(n){callbackHandler(n,e,t)}).fail(function(){failure()})},e.prototype.GetFolders=function(e,t,n){$.post(_sealServer+"SWIGetFolders",{path:e}).done(function(e){callbackHandler(e,t,n)}).fail(function(){failure()})},e.prototype.GetFolderDetail=function(e,t,n){$.post(_sealServer+"SWIGetFolderDetail",{path:e}).done(function(e){callbackHandler(e,t,n)}).fail(function(){failure()})},e.prototype.CreateFolder=function(e,t,n){$.post(_sealServer+"SWICreateFolder",{path:e}).done(function(e){callbackHandler(e,t,n)}).fail(function(){failure()})},e.prototype.DeleteFolder=function(e,t,n){$.post(_sealServer+"SWIDeleteFolder",{path:e}).done(function(e){callbackHandler(e,t,n)}).fail(function(){failure()})},e.prototype.RenameFolder=function(e,t,n,o){$.post(_sealServer+"SWIRenameFolder",{source:e,destination:t}).done(function(e){callbackHandler(e,n,o)}).fail(function(){failure()})},e.prototype.Search=function(e,t,n,o){$.post(_sealServer+"SWISearch",{path:e,pattern:t}).done(function(e){callbackHandler(e,n,o)}).fail(function(){failure()})},e.prototype.ExecuteReport=function(e,t,n,o,i,a){$.post(_sealServer+"SWIExecuteReport",{path:e,render:t,viewGUID:n,outputGUID:o}).done(function(e){callbackHandler(e,i,a)}).fail(function(){failure()})},e.prototype.ExecuteReportDefinition=function(e,t,n,o,i,a){$.post(_sealServer+"SWIExecuteReportDefinition",{report:e,render:t,viewGUID:n,outputGUID:o}).done(function(e){callbackHandler(e,i,a)}).fail(function(){failure()})},e.prototype.ViewFile=function(e,t,n){$.post(_sealServer+"SWIViewFile",{path:e}).done(function(e){callbackHandler(e,t,n)}).fail(function(){failure()})},e.prototype.GetReportDetail=function(e,t,n){$.post(_sealServer+"SWIGetReportDetail",{path:e}).done(function(e){callbackHandler(e,t,n)}).fail(function(){failure()})},e.prototype.NewReportDefinition=function(e,t,n){$.post(_sealServer+"SWINewReportDefinition",{path:e}).done(function(e){callbackHandler(e,t,n)}).fail(function(){failure()})},e.prototype.GetReportDefinition=function(e,t,n){$.post(_sealServer+"SWIGetReportDefinition",{path:e}).done(function(e){callbackHandler(e,t,n)}).fail(function(){failure()})},e.prototype.SaveReportDefinition=function(e,t,n,o,i){$.post(_sealServer+"SWISaveReportDefinition",{path:e,check:t,report:n}).done(function(e){callbackHandler(e,o,i)}).fail(function(){failure()})},e}(),$waitDialog,$editDialog,$folderTree,$loginModal,$outputPanel,$propertiesPanel,$elementDropDown,_gateway,_main,_editor;$(document).ready(function(){_gateway=new SWIGateway,_main=new SWIMain,_main.Process()});var SWIMain=function(){function e(){this._connected=!1,this._profile=null,this._folder=null,this._searchMode=!1,this._clipboardCut=!1,this._folderpath="\\"}return e.prototype.Process=function(){$waitDialog=$("#wait-dialog"),$editDialog=$("#edit-dialog"),$folderTree=$("#folder-tree"),$loginModal=$("#login-modal"),$outputPanel=$("#output-panel"),$propertiesPanel=$("#properties-panel"),$elementDropDown=$("#element-dropdown"),$(".navbar-right").hide(),$waitDialog.modal(),$("#search-pattern").keypress(function(e){13==(e.keyCode||e.which)&&_main.search()}),$("#password,#username").keypress(function(e){13==(e.keyCode||e.which)&&_main.login()}),$("#login-modal-submit").unbind("click").on("click",function(e){_main.login()}),_gateway.GetVersions(function(e){$("#brand-id").attr("title",SWIUtil.tr("Web Interface Version")+" : "+e.SWIVersion+" - "+SWIUtil.tr("Server Version")+" : "+e.SRVersion)}),_gateway.GetUserProfile(function(e){_main.loginSuccess(e)},function(e){_gateway.Login("","",function(e){_main.loginSuccess(e)},function(e){_main.loginFailure(e)})}),$(window).on("resize",function(){_main.resize()})},e.prototype.loginSuccess=function(e){_main._connected=!0,_main._profile=e,$loginModal.modal("hide"),SWIUtil.HideMessages(),$(".navbar-right").show(),$("#footer-div").hide(),$("#password").val(""),$("#login-modal-error").text(""),_main.loadFolderTree(),$("#main-container").css("display","block"),$("#refresh-nav-item").unbind("click").on("click",function(e){_main.ReloadReportsTable(),SWIUtil.ShowMessage("alert-success",SWIUtil.tr("The folder has been updated"),5e3)}),$("#folders-nav-item").unbind("click").on("click",function(e){$outputPanel.hide(),$("#create-folder-name").val(""),$("#rename-folder-name").val(_main._folder.name),SWIUtil.ShowHideControl($("#folder-rename").parent(),2==_main._folder.manage),SWIUtil.ShowHideControl($("#folder-delete").parent(),_main._folder.isEmpty&&2==_main._folder.manage),$("#folder-create").unbind("click").on("click",function(e){$("#folder-dialog").modal("hide");var t=_main._folder.path+("\\"==_main._folder.path?"":"\\")+$("#create-folder-name").val();_gateway.CreateFolder(t,function(e){_main._profile.folder=t,_main.loadFolderTree(),SWIUtil.ShowMessage("alert-success",SWIUtil.tr("The folder has been created"),5e3)})}),$("#folder-rename").unbind("click").on("click",function(e){$("#folder-dialog").modal("hide");var t=SWIUtil.GetDirectoryName(_main._folder.path)+"\\"+$("#rename-folder-name").val();_gateway.RenameFolder(_main._folder.path,t,function(e){_main._profile.folder=t,_main.loadFolderTree(),SWIUtil.ShowMessage("alert-success",SWIUtil.tr("The folder has been renamed"),5e3)})}),$("#folder-delete").unbind("click").on("click",function(e){$("#folder-dialog").modal("hide"),_gateway.DeleteFolder(_main._folder.path,function(e){_main._profile.folder=SWIUtil.GetDirectoryName(_main._folder.path),_main.loadFolderTree(),SWIUtil.ShowMessage("alert-success",SWIUtil.tr("The folder has been deleted"),5e3)})}),$("#folder-dialog").modal()}),$("#search-nav-item").unbind("click").on("click",function(e){$outputPanel.hide(),_main.search()}),$("#profile-nav-item").unbind("click").on("click",function(e){$outputPanel.hide(),$("#profile-user").val(_main._profile.name),$("#profile-groups").val(_main._profile.group);var t=$("#culture-select");0==t.children("option").length?_gateway.GetCultures(function(e){for(var n=0;n<e.length;n++)t.append(SWIUtil.GetOption(e[n].id,e[n].val,_main._profile.culture));t.selectpicker("refresh")}):t.val(_main._profile.culture).change(),t.selectpicker("refresh"),$("#profile-save").unbind("click").on("click",function(e){$("#profile-dialog").modal("hide"),_gateway.SetUserProfile($("#culture-select").val(),function(e){location.reload(!0)})}),$("#profile-dialog").modal()}),$("#disconnect-nav-item").unbind("click").on("click",function(e){SWIUtil.HideMessages(),$outputPanel.hide(),_gateway.Logout(function(e){_main._connected=!1,$("#main-container").css("display","none"),_main.showLogin()})}),$("#report-delete-lightbutton").unbind("click").on("click",function(e){$outputPanel.hide();var t=$(".report-checkbox:checked").length;$("#message-title").html(SWIUtil.tr("Warning")),$("#message-text").html(SWIUtil.tr("Do you really want to delete the reports or files selected ?")),$("#message-ok-button").unbind("click").on("click",function(e){$("#message-dialog").modal("hide"),$waitDialog.modal();var n="";$(".report-checkbox:checked").each(function(e,t){n+=$(t).data("path")+"\n"}),_gateway.DeleteFiles(n,function(e){SWIUtil.ShowMessage("alert-success",t+" "+SWIUtil.tr("report(s) or file(s) have been deleted"),5e3),_main.ReloadReportsTable(),$waitDialog.modal("hide")})}),$("#message-dialog").modal()}),$("#report-rename-lightbutton").unbind("click").on("click",function(e){$outputPanel.hide();var t=$(".report-checkbox:checked").first().data("path"),n=t.split("\\").pop(),o=n.split(".").pop();$("#report-name-save").unbind("click").on("click",function(e){$waitDialog.modal();var n=_main._folder.path,i=("\\"!=n?n:"")+"\\"+$("#report-name").val()+"."+o;$("#report-name-dialog").modal("hide"),_gateway.MoveFile(t,i,!1,function(e){_main.ReloadReportsTable(),$waitDialog.modal("hide"),SWIUtil.ShowMessage("alert-success",SWIUtil.tr("The report or file has been renamed"),5e3)})}),$("#report-name").val(n.replace(/\.[^\/.]+$/,"")),$("#report-name-dialog").modal()}),$("#report-copy-lightbutton").unbind("click").on("click",function(e){$outputPanel.hide(),_main._clipboard=[],$(".report-checkbox:checked").each(function(e,t){_main._clipboard[e]=$(t).data("path")}),_main._clipboardCut=!1,_main.enableControls(),SWIUtil.ShowMessage("alert-success",_main._clipboard.length.toString()+" "+SWIUtil.tr("report(s) or files(s) copied in the clipboard"),5e3)}),$("#report-cut-lightbutton").unbind("click").on("click",function(e){$outputPanel.hide(),_main._clipboard=[],$(".report-checkbox:checked").each(function(e,t){_main._clipboard[e]=$(t).data("path")}),_main._clipboardCut=!0,_main.enableControls(),SWIUtil.ShowMessage("alert-success",_main._clipboard.length.toString()+" "+SWIUtil.tr("report(s) or file(s) cut in the clipboard"),5e3)}),$("#report-paste-lightbutton").unbind("click").on("click",function(e){$outputPanel.hide(),_main._clipboard&&_main._clipboard.length>0&&($waitDialog.modal(),_main._clipboard.forEach(function(e,t){var n=e.split("\\").pop().split("/").pop(),o=_main._folder.path,i=("\\"!=o?o:"")+"\\"+n;_gateway.MoveFile(e,i,!_main._clipboardCut,function(e){t==_main._clipboard.length-1&&setTimeout(function(){_main.ReloadReportsTable(),$waitDialog.modal("hide"),SWIUtil.ShowMessage("alert-success",_main._clipboard.length.toString()+" "+SWIUtil.tr("report(s) or file(s) processed"),5e3)},2e3)})}))}),_main.enableControls(),_main.resize()},e.prototype.search=function(){$waitDialog.modal(),_gateway.Search(_main._folder.path,$("#search-pattern").val(),function(e){_main._searchMode=!0,_main.buildReportsTable(e),$waitDialog.modal("hide")})},e.prototype.loginFailure=function(e){$waitDialog.modal("hide"),_main._connected=!1,""!=$("#username").val()&&$("#login-modal-error").text(e.error),$loginModal.hasClass("in")||_main.showLogin(),_main.enableControls()},e.prototype.showLogin=function(){$loginModal.modal()},e.prototype.login=function(){$loginModal.modal("hide"),$waitDialog.modal(),_gateway.Login($("#username").val(),$("#password").val(),function(e){_main.loginSuccess(e)},function(e){_main.showLogin(),_main.loginFailure(e)})},e.prototype.resize=function(){$("#file-table-view").height($(window).height()-125)},e.prototype.enableControls=function(){var e=0;_main._folder&&(e=_main._folder.right),$outputPanel.hide(),SWIUtil.EnableButton($("#report-edit-lightbutton"),e>=folderRightEdit),SWIUtil.ShowHideControl($("#report-edit-lightbutton"),hasEditor);var t=$(".report-checkbox:checked").length;SWIUtil.EnableButton($("#report-rename-lightbutton"),1==t&&e>=folderRightEdit),SWIUtil.EnableButton($("#report-delete-lightbutton"),0!=t&&e>=folderRightEdit),SWIUtil.EnableButton($("#report-cut-lightbutton"),0!=t&&e>=folderRightEdit),SWIUtil.EnableButton($("#report-copy-lightbutton"),0!=t&&e>0),SWIUtil.EnableButton($("#report-paste-lightbutton"),null!=this._clipboard&&this._clipboard.length>0&&e>=folderRightEdit),SWIUtil.ShowHideControl($("#folders-nav-item"),!!_main._folder&&_main._folder.manage>0),$("#search-pattern").css("background",_main._searchMode?"orange":"white")},e.prototype.toJSTreeFolderData=function(e,t,n){for(var o=0;o<e.length;o++){var i=e[o];t[t.length]={id:i.path,parent:n,text:""==i.name?"Reports":i.name,state:{opened:i.expand,selected:""==i.name}},i.folders&&i.folders.length>0&&_main.toJSTreeFolderData(i.folders,t,i.path)}return t},e.prototype.loadFolderTree=function(){_gateway.GetRootFolders(function(e){var t=[];$folderTree.jstree("destroy").empty(),$folderTree.jstree({core:{animation:0,themes:{stripes:!0},data:_main.toJSTreeFolderData(e,t,"#")},types:{default:{icon:"fa fa-folder-o"}},plugins:["types","wholerow"]}),$folderTree.on("changed.jstree",function(e,t){_main.ReloadReportsTable()}),setTimeout(function(){_main._profile.folder&&""!=_main._profile.folder||(_main._profile.folder="\\"),_main._folderpath=_main._profile.folder,$folderTree.jstree("deselect_all"),$folderTree.jstree("select_node",_main._folderpath)},100),$waitDialog.modal("hide")})},e.prototype.ReloadReportsTable=function(){_main.LoadReports($folderTree.jstree("get_selected")[0])},e.prototype.LoadReports=function(e){e&&_gateway.GetFolderDetail(e,function(t){_main._searchMode=!1,_main._folder=t.folder,_main._folder.isEmpty=0==t.files.length&&0==$folderTree.jstree("get_selected",!0)[0].children.length,_main.buildReportsTable(t),_main._profile.folder=e})},e.prototype.buildReportsTable=function(e){$("#file-table").dataTable().fnDestroy();var t=$("#file-table-body");t.empty();for(var n=0;n<e.files.length;n++){var o=$("<tr>"),i=e.files[n];t.append(o),o.append($("<td>").append($("<input>").addClass("report-checkbox").prop("type","checkbox").data("path",i.path))),o.append($("<td>").append($("<a>").addClass("report-name").data("path",i.path).data("isReport",i.isReport).text(i.name)));var a=$("<td>").css("text-align","center").data("path",i.path);o.append(a),i.isReport&&(a.append($("<button>").prop("type","button").prop("title",SWIUtil.tr("Views and outputs")).addClass("btn btn-default btn-table fa fa-list-ul report-output")),i.right>=folderRightSchedule&&hasEditor&&a.append($("<button>").prop("type","button").prop("title",SWIUtil.tr("Edit report")).addClass("btn btn-default fa fa-pencil report-edit"))),o.append($("<td>").css("text-align","right").text(i.last))}var r=$("#selectall-checkbox");r.prop("checked",!1),$("#selectall-checkbox").unbind("click").bind("click",function(){$(".report-checkbox").each(function(e,t){var n=r.is(":checked");$(t).prop("checked",n)}),_main.enableControls()}),$(".report-name").on("click",function(e){$waitDialog.modal(),$outputPanel.hide(),$(e.currentTarget).data("isReport")?_gateway.ExecuteReport($(e.currentTarget).data("path"),!1,null,null,function(e){$waitDialog.modal("hide");var t=window.open("about:blank");t.document.open(),t.document.write(e),t.document.close()}):_gateway.ViewFile($(e.currentTarget).data("path"),function(e){$waitDialog.modal("hide"),window.open(e.url)})}),$(".report-output").on("click",function(e){$outputPanel.hide();var t=$(e.currentTarget),n=$("#output-table-body");$outputPanel.css({display:"inline",position:"absolute","z-index":"10000",left:t.offset().left-120,top:t.offset().top+t.height()+10}).show(),$("#output-panel-close").on("click",function(){$outputPanel.hide()}),_gateway.GetReportDetail(t.parent().data("path"),function(e){n.empty();for(var o=0;o<e.views.length;o++){var i=$("<tr>");n.append(i),i.append($("<td>").append($("<a>").data("viewguid",e.views[o].guid).addClass("output-name").text(e.views[o].displayName))),i.append($("<td>").html(SWIUtil.tr("View")))}for(var o=0;o<e.outputs.length;o++){var i=$("<tr>");n.append(i),i.append($("<td>").append($("<a>").data("outputguid",e.outputs[o].guid).addClass("output-name").text(e.outputs[o].displayName))),i.append($("<td>").html(SWIUtil.tr("Output")))}$(".output-name").on("click",function(e){$outputPanel.hide(),$waitDialog.modal(),_gateway.ExecuteReport(t.parent().data("path"),!1,$(e.currentTarget).data("viewguid"),$(e.currentTarget).data("outputguid"),function(e){$waitDialog.modal("hide");var t=window.open("about:blank");t.document.open(),t.document.write(e),t.document.close()})})},function(e){SWIUtil.ShowMessage("alert-danger",e.error,0),$outputPanel.hide()})}),_editor&&_editor.init(),$("#file-table").dataTable({sDom:'<"dataTableTop"lfpri>t',bSort:!0,stateSave:!0,aaSorting:[],bPaginate:!0,sPaginationType:"full_numbers",iDisplayLength:25,bInfo:!0,bFilter:!0,bAutoWidth:!1,oLanguage:{oPaginate:{sFirst:"|&lt;",sPrevious:"&lt;&lt;",sNext:">>",sLast:">|"},sSearch:SWIUtil.tr("Filter")+" ",sZeroRecords:SWIUtil.tr("No report"),sLengthMenu:SWIUtil.tr("Show _MENU_ reports"),sInfo:SWIUtil.tr("Showing _START_ to _END_ of _TOTAL_"),sInfoEmpty:SWIUtil.tr("Showing 0 to 0 of 0"),sInfoFiltered:SWIUtil.tr("(filtered from _MAX_)"),sInfoPostFix:""},aoColumnDefs:[{bSortable:!1,aTargets:[0,2]}]}),$(".report-checkbox").on("click",function(){_main.enableControls()}),_main.enableControls()},e}(),$elementsTree,$sourceSelect,$pivotMode,$gridMode,_ed;$(document).ready(function(){_editor=new SWIEditor});var SWIEditor=function(){function e(){this._isModified=!1,this._isNew=!1,this._canRender=!1,this._reload=!1}return e.prototype.init=function(){_ed=this,$(".report-edit").unbind("click").on("click",function(e){$waitDialog.modal(),$elementsTree=$("#elements-tree"),$sourceSelect=$("#source-select"),$pivotMode=$("#pivot-mode-btn"),$gridMode=$("#grid-mode-btn");var t=_main._folder.path,n=$(this).parent().data("path");null==n?(n=t+("\\"==t?"":"\\")+SWIUtil.tr("New report")+".srex",_ed._isNew=!0,_gateway.NewReportDefinition(n,function(e){_ed.loadReport(e)})):_gateway.GetReportDefinition(n,function(e){_ed.loadReport(e)}),_ed.handleButtons(),$outputPanel.hide()})},e.prototype.loadReport=function(e){$waitDialog.modal("hide"),_ed._report=e,_ed._canRender=!1,_ed._isModified=!1,$sourceSelect.empty();for(var t=0;t<_ed._report.sources.length;t++)$sourceSelect.append(SWIUtil.GetOption(_ed._report.sources[t].guid,e.sources[t].name,_ed._report.sourceguid,"fa fa-database"));$sourceSelect.val(_ed._report.sourceguid).change(),$sourceSelect.selectpicker("refresh"),$sourceSelect.on("hidden.bs.select",function(e){$sourceSelect.selectpicker("val")!=_ed._report.sourceguid&&(_ed._report.sourceguid=$sourceSelect.selectpicker("val"),$("#page-panel,#row-panel,#col-panel,#data-panel").empty(),_ed.setSource(),_ed.setModified(!1))}),_ed.initElementsTree(),_ed.initDragPanels(),_ed.initOptionsPanel(),_ed.initSchedulePanel(),_ed.setStatus("",""),_ed.enableControls(),$editDialog.modal()},e.prototype.handleButtons=function(){$("#nav-dialog-execute,#nav-dialog-render,#nav-dialog-execute-schedule").unbind("click").on("click",function(e){_ed.hidePanels();var t=_ed.getReportDefinition();$waitDialog.modal();var n="nav-dialog-execute-schedule"==$(this).attr("id")?"1":"";""!=n&&(_ed._reload=!0),_gateway.ExecuteReportDefinition(JSON.stringify(t),"nav-dialog-render"==$(this).attr("id"),null,n,function(e){$waitDialog.modal("hide"),_ed.setStatus("",""),_ed._canRender=!0,_ed.enableControls();var t=window.open("about:blank");t.document.open(),t.document.write(e),t.document.close()},function(e){$waitDialog.modal("hide"),e.error&&(_ed.setStatus("label-danger","Error"),SWIUtil.ShowMessage("alert-danger",e.error,0))})}),$("#nav-dialog-close").unbind("click").on("click",function(e){_ed.hidePanels(),_ed._isModified?($("#message-title").html(SWIUtil.tr("Warning")),$("#message-text").html(SWIUtil.tr("Report has been modified, do you really want to close ?")),$("#message-ok-button").unbind("click").on("click",function(e){$("#message-dialog").modal("hide"),$editDialog.modal("hide"),_ed.refreshFolder()}),$("#message-dialog").modal()):($editDialog.modal("hide"),_ed.refreshFolder())}),$("#nav-dialog-save").unbind("click").on("click",function(e){_ed.hidePanels(),_ed.saveReport(_ed._report.path)}),_ed.setPivotMode(!1),$pivotMode.unbind("click").on("click",function(e){_ed.setPivotMode(!0)}),$gridMode.unbind("click").on("click",function(e){_ed.setPivotMode(!1)}),$("#nav-dialog-schedule").unbind("click").on("click",function(e){_ed.displayPanels(2)}),$("#nav-dialog-elements").css("display",_main._folder.right>=folderRightEdit?"inline":"none"),$("#nav-dialog-options").css("display",_main._folder.right>=folderRightEdit?"inline":"none"),_main._folder.right>=folderRightEdit?($("#nav-dialog-elements").unbind("click").on("click",function(e){_ed.displayPanels(0)}),$("#nav-dialog-options").unbind("click").on("click",function(e){_ed.displayPanels(1)}),_ed.displayPanels(0)):_ed.displayPanels(2)},e.prototype.refreshFolder=function(){if(_ed._reload){$folderTree.jstree("deselect_all",!0);var e=SWIUtil.GetDirectoryName(_ed._report.path);$folderTree.jstree("select_node",""==e?"\\":e)}},e.prototype.setPivotMode=function(e){e?($pivotMode.addClass("active"),$gridMode.removeClass("active")):($gridMode.addClass("active"),$pivotMode.removeClass("active")),_ed.resizePanels()},e.prototype.displayPanels=function(e){_ed.hidePanels(),SWIUtil.ActivatePanel($("#nav-dialog-elements"),$("#elements-row"),0==e),SWIUtil.ActivatePanel($("#nav-dialog-options"),$("#options-row"),1==e),SWIUtil.ActivatePanel($("#nav-dialog-schedule"),$("#schedule-row"),2==e)},e.prototype.resizePanels=function(){$pivotMode.hasClass("active")?($("#page-panel").css("display","block").height(150).children("span").css("top",117).html(SWIUtil.tr("Drop your Page elements")+"..."),$("#col-panel").css("display","block").height(150).children("span").css("top",117).html(SWIUtil.tr("Drop your Column elements")+"..."),$("#row-panel").height(240).children("span").css("top",207).html(SWIUtil.tr("Drop your Row elements")+"..."),$("#data-panel").height(240).children("span").css("top",207).html(SWIUtil.tr("Drop your Data elements")+"..."),$("#restriction-panel").height(100).children("span").css("top",67).html(SWIUtil.tr("Drop your Restrictions")+"...")):($("#page-panel").css("display","none"),$("#col-panel").css("display","none"),$("#row-panel").height(340).children("span").css("top",307).html(SWIUtil.tr("Drop your Elements")+"..."),$("#data-panel").height(340).children("span").css("top",307).html(SWIUtil.tr("Drop your Data")+"..."),$("#restriction-panel").height(158).children("span").css("top",125).html(SWIUtil.tr("Drop your Restrictions")+"..."))},e.prototype.hidePanels=function(){SWIUtil.HideMessages(),$propertiesPanel.hide(),$elementDropDown.hide()},e.prototype.setModified=function(e){_ed._canRender&&!e&&(_ed._canRender=!1,_ed.enableControls()),_ed._isModified||(_ed._isModified=!0,_ed.setStatus("",""),_ed.enableControls())},e.prototype.enableControls=function(){SWIUtil.EnableLinkInput($("#nav-dialog-render"),_ed._canRender);var e=$("#breadcrumb");e.empty();for(var t=_ed._report.folder.split("\\"),n=0;n<t.length;n++)""!=t[n]&&e.append($("<li>").append("<span>").html(t[n]));e.append($("<li>").append("<span>").html(_ed._report.path.split("\\").pop().replace(".srex",""))),_ed._isModified&&$("#breadcrumb").append("<span class='badge' style='margin:0px 5px'>"+SWIUtil.tr("Modified")+"</span>")},e.prototype.setStatus=function(e,t){$("#status-message").removeClass().addClass("label").addClass(e).html(t)},e.prototype.getReportDefinition=function(){var e=JSON.parse(JSON.stringify(_ed._report));return e.sources=null,e.els=[],$("#page-panel, #row-panel, #col-panel, #data-panel, #restriction-panel").find(".element-btn").each(function(t,n){e.els[e.els.length]=$(n).data("element")}),e},e.prototype.saveReport=function(e){var t=_ed.getReportDefinition();_ed._isNew?($("#report-name-save").unbind("click").on("click",function(e){_ed._report.path=_main._folder.path+("\\"==_main._folder.path?"":"\\")+$("#report-name").val()+".srex",_ed.saveReport2(_ed._report.path,!0,t)}),$("#report-name").val(_ed._report.path.split("\\").pop().replace(".srex","")),$("#report-name-dialog").modal()):_ed.saveReport2(_ed._report.path,!1,t)},e.prototype.saveReport2=function(e,t,n){$(".btn").attr("disabled","true"),$waitDialog.modal(),_gateway.SaveReportDefinition(e,t,JSON.stringify(n),function(e){$(".btn").removeAttr("disabled"),$waitDialog.modal("hide"),$("#report-name-dialog").modal("hide"),_ed._isModified=!1,_ed._isNew=!1,_ed.setStatus("label-success",SWIUtil.tr("Report saved")),_ed.enableControls(),_ed._reload=!0},function(e){$(".btn").removeAttr("disabled"),$waitDialog.modal("hide"),e.error&&(_ed.setStatus("label-danger",SWIUtil.tr("Error")),SWIUtil.ShowMessage("alert-danger",e.error,0))})},e.prototype.initElementsTree=function(){$elementsTree.jstree({core:{animation:0,themes:{stripes:!0},data:[]},types:{default:{icon:"fa fa-folder-o"},leaf:{icon:"fa fa-cube"}},plugins:["types","wholerow"]}),$elementsTree.bind("click.jstree",function(e){_ed.hidePanels()}),$elementsTree.bind("dblclick.jstree",function(e){var t=$(e.target).closest("li");e.stopImmediatePropagation();var n=_ed.GetMetaColumn(t.attr("id"));if(null!=n){var o=_ed.createButtonGroup(n,null);$("#row-panel").append(o.Group),o.PropButton.on("click",function(e){SWIProperties.ShowPropertiesPanel(o,_ed._report,e)}),o.Element.position=1,_ed.setModified(!1)}}),$elementsTree.bind("mousedown.jstree",function(e){var t=$(e.target).closest("li");return _ed._dragTreeSource=null,_ed._dragPanelSource=null,!!$elementsTree.jstree("is_leaf",t)&&(t.prop("draggable","true"),void t.on("dragstart",function(e){$(this).removeClass("over"),_ed.hidePanels(),_ed._dragTreeSource=t,_ed._dragPanelSource=null,$(".element-btn").removeClass("over2")}))}),_ed.setSource()},e.prototype.toJSTreeElementsData=function(e,t,n){for(var o=0;o<e.length;o++){var i=e[o],a=null==i.guid?i.path:i.guid;t[t.length]={id:a,parent:n,text:i.name,type:null!=i.guid?"leaf":""},null!=i.cols&&_ed.toJSTreeElementsData(i.cols,t,a)}return t},e.prototype.setSource=function(){for(var e=0;e<_ed._report.sources.length;e++)if(_ed._report.sources[e].guid==_ed._report.sourceguid){_ed._currentSource=_ed._report.sources[e];break}$elementsTree.jstree(!0).settings.core.data=_ed.toJSTreeElementsData(_ed._currentSource.cols,[],"#"),$elementsTree.jstree(!0).refresh(!1,!0)},e.prototype.GetMetaColumn=function(e){return _ed.getMetaColumn(e,_ed._currentSource.cols)},e.prototype.getMetaColumn=function(e,t){if(e){for(var n=0;n<t.length;n++){if(t[n].guid==e)return t[n];if(t[n].cols){var o=_ed.getMetaColumn(e,t[n].cols);if(o)return o}}return null}},e.prototype.createButtonGroup=function(e,t){null==t&&(t={guid:SWIUtil.Newguid(),type:e.type,metaguid:e.guid,metaname:e.name,name:e.name,sort:"Automatic Ascendant",position:1,serie:0,chart:-1,aggr:0,totals:0,totalsaggr:0,oper:0,prompt:0,required:0,evals:[]}),e||(e=_ed.GetMetaColumn(t.metaguid));var n=new SWIButtonGroup(t,e);return n.Button.on("dragstart",function(e){_ed.hidePanels(),_ed._dragPanelSource=n,_ed._dragTreeSource=null,$(".element-btn").removeClass("over2")}),n.Button.on("click",function(e){e.stopImmediatePropagation(),_ed.hidePanels(),$elementsTree.jstree("deselect_all"),$elementsTree.jstree("select_node",t.metaguid),$elementsTree.scrollTop($elementsTree.find("#"+t.metaguid+"_anchor")[0].offsetTop)}),n.DropButton.unbind("click").on("click",function(o){
o.stopImmediatePropagation(),$elementDropDown.data("element",t),$elementDropDown.css("position","fixed"),$elementDropDown.css("left",o.pageX-145),$elementDropDown.css("top",o.pageY+5),$elementDropDown.css("display","inline"),SWIUtil.ShowHideControl($("#el-prompt-dropdown"),10!=t.position),$("#el-copy-dropdown").unbind("click").on("click",function(o){var i=_ed.createButtonGroup(e,null);for(var a in t)i.Element[a]=t[a];i.Element.guid=SWIUtil.Newguid(),n.Group.parent().append(i.Group),i.Redraw(),_ed.setModified(!1),$elementDropDown.hide()}),$("#el-prompt-dropdown").unbind("click").on("click",function(t){var n=_ed.createButtonGroup(e,null);n.Element.prompt=1,n.Element.position=10,$("#restriction-panel").append(n.Group),n.Redraw(),_ed.setModified(!1),$elementDropDown.hide()}),$("#el-remove-dropdown").unbind("click").on("click",function(e){n.Group.remove(),_ed.setModified(!1),$elementDropDown.hide()}),$("#el-removeall-dropdown").unbind("click").on("click",function(e){n.Group.parent().empty(),_ed.setModified(!1),$elementDropDown.hide()})}),n.Redraw(),n.PropButton.unbind("click").on("click",function(e){e.stopImmediatePropagation(),SWIProperties.ShowPropertiesPanel(n,_ed._report,e)}),n},e.prototype.initOptionsPanel=function(){var e=_ed._report.options,t=null;t=this.InitStandardInput("#option-title",e.title,function(t){e.title=t}),t=this.InitStandardInput("#option-description",e.description,function(t){e.description=t}),t=this.InitStandardInput("#option-chart-title",e.charttitle,function(t){e.charttitle=t}),t=this.InitStandardInput("#option-chart-height",e.chartheight,function(t){e.chartheight=t},!0),t=this.InitStandardInput("#option-chart-width",e.chartwidth,function(t){e.chartwidth=t},!0);var n=$("#option-format");n.unbind("change"),n.selectpicker("destroy"),n.empty(),n.append(SWIUtil.GetOption("0",SWIUtil.tr("HTML"),e.format,"fa fa-file-text-o")),n.append(SWIUtil.GetOption("1",SWIUtil.tr("HTML Print"),e.format,"fa fa-file-text-o")),n.append(SWIUtil.GetOption("2",SWIUtil.tr("CSV"),e.format,"fa fa-file-excel-o")),n.append(SWIUtil.GetOption("3",SWIUtil.tr("Excel"),e.format,"fa fa-file-excel-o")),n.append(SWIUtil.GetOption("4",SWIUtil.tr("PDF"),e.format,"fa fa-file-pdf-o")),n.append(SWIUtil.GetOption("5",SWIUtil.tr("PDF Print"),e.format,"fa fa-file-pdf-o")),n.on("change",function(t){_ed.setModified(!1),e.format=$(this).val()}),n.selectpicker("refresh"),n=$("#option-connection"),n.unbind("change"),n.selectpicker("destroy"),n.empty(),n.append(SWIUtil.GetOption("2",SWIUtil.tr("Default report connection"),e.connectionguid)),n.append(SWIUtil.GetOption("1",SWIUtil.tr("Default repository connection"),e.connectionguid)),$.each(_ed._currentSource.conns,function(t,o){n.append(SWIUtil.GetOption(o.guid,o.name,e.connectionguid))}),n.on("change",function(t){_ed.setModified(!1),e.connectionguid=$(this).val()}),n.selectpicker("refresh");var o=$("#option-force-execution");o.val(e.format),o.on("click",function(t){_ed.setModified(!1),e.forceexec=$(this).is(":checked")});var i=$("#option-body");i.empty(),i.append(this.CreateOptionCheckbox(SWIUtil.tr("Use data tables"),e.datatables,function(t){e.datatables=t})),i.append(this.CreateOptionCheckbox(SWIUtil.tr("Show restrictions panel"),e.showrestr,function(t){e.showrestr=t})),i.append(this.CreateOptionCheckbox(SWIUtil.tr("Show information panel"),e.showinfo,function(t){e.showinfo=t})),i.append(this.CreateOptionCheckbox(SWIUtil.tr("Show execution message panel"),e.showmsg,function(t){e.showmsg=t})),i.append(this.CreateOptionCheckbox(SWIUtil.tr("Show report result panel"),e.showresult,function(t){e.showresult=t})),i.append(this.CreateOptionCheckbox(SWIUtil.tr("Force execution"),e.forceexec,function(t){e.forceexec=t}))},e.prototype.enableScheduleControls=function(){var e=1==_ed._report.schedule.device,t=2==_ed._report.schedule.device,n=_ed._report.schedule.type;SWIUtil.ShowHideControl($(".schedule-execute"),t||e),SWIUtil.ShowHideControl($(".schedule-folder"),t),SWIUtil.ShowHideControl($(".schedule-email"),e),SWIUtil.ShowHideControl($("#schedule-weekdays").parent().parent(),3==n),SWIUtil.ShowHideControl($("#schedule-interval").parent().parent(),2==n||3==n),2==n?$("#schedule-interval-label").html(SWIUtil.tr("days")):3==n&&$("#schedule-interval-label").html(SWIUtil.tr("weeks")),SWIUtil.ShowHideControl($("#schedule-months").parent().parent(),4==n),SWIUtil.ShowHideControl($("#schedule-days").parent().parent(),4==n),SWIUtil.ShowHideControl($("#schedule-exec").parent().parent(),e||t)},e.prototype.initSchedulePanel=function(){var e=_ed._report.schedule,t=$("#schedule-device");t.unbind("change"),t.selectpicker("destroy"),t.empty(),t.append(SWIUtil.GetOption("0",SWIUtil.tr("No schedule"),e.device)),t.append(SWIUtil.GetOption("1",SWIUtil.tr("Email"),e.device,"fa fa-envelope-o")),_ed._report.folders.length>0&&(t.append(SWIUtil.GetOption("2",SWIUtil.tr("Folder"),e.device,"fa fa-folder-open-o")),null==e.folder&&(e.folder=_ed._report.folders[0].id)),t.on("change",function(t){_ed.setModified(!1),e.device=$(this).val(),_ed.enableScheduleControls()}),t.selectpicker("refresh"),t=$("#schedule-folder"),t.unbind("change"),t.selectpicker("destroy"),t.empty(),$.each(_ed._report.folders,function(n,o){t.append(SWIUtil.GetOption(o.id,o.val,e.folder,"fa fa-folder-o"))}),t.on("change",function(t){_ed.setModified(!1),e.folder=$(this).val()}),t.selectpicker("refresh");var n;n=this.InitStandardInput("#schedule-file",e.file,function(t){e.file=t});var o=SWIUtil.GetReportName(_ed._report.path),i=$("#schedule-file-dropdown");i.empty(),i.append($("<li><a>"+displayNameKeyword+"</a></li>")),i.append($("<li><a>"+displayNameKeyword+"_{0:yyyy_MM_dd}</a></li>")),i.append($("<li><a>"+displayNameKeyword+"_{0:yyyy_MM_dd HH_mm_ss}</a></li>")),i.append($("<li><a>"+o+"</a></li>")),i.append($("<li><a>"+o+"_{0:yyyy_MM_dd}</a></li>")),i.append($("<li><a>"+o+"_{0:yyyy_MM_dd HH_mm_ss}</a></li>")),$("#schedule-file-dropdown > li > a").unbind("click").on("click",function(){_ed.setModified(!0),$("#schedule-file").val($(this).text()),e.file=$(this).text()}),n=this.InitStandardInput("#schedule-from",e.from,function(t){e.from=t}),n=this.InitStandardInput("#schedule-to",e.to,function(t){e.to=t}),n=this.InitStandardInput("#schedule-cc",e.cc,function(t){e.cc=t}),n=this.InitStandardInput("#schedule-bcc",e.bcc,function(t){e.bcc=t}),n=this.InitStandardInput("#schedule-subject",e.subject,function(t){e.subject=t}),n=this.InitStandardInput("#schedule-body",e.body,function(t){e.body=t}),t=this.InitBoolSelect("#schedule-html",e.html,SWIUtil.tr("Yes (the HTML result is the body)"),SWIUtil.tr("No"),function(t){e.html=t}),t=this.InitBoolSelect("#schedule-zip",e.zip,SWIUtil.tr("Yes (the attachments are zipped)"),SWIUtil.tr("No"),function(t){e.zip=t}),n=this.InitStandardInput("#schedule-zippassword",e.zippassword,function(t){e.zippassword=t}),n=this.InitStandardDatePicker("#schedule-start",e.start,function(t){e.start=t}),t=$("#schedule-type"),t.unbind("change"),t.selectpicker("destroy"),t.empty(),t.append(SWIUtil.GetOption("1",SWIUtil.tr("One time"),e.type)),t.append(SWIUtil.GetOption("2",SWIUtil.tr("Daily"),e.type)),t.append(SWIUtil.GetOption("3",SWIUtil.tr("Weekly"),e.type)),t.append(SWIUtil.GetOption("4",SWIUtil.tr("Monthly"),e.type)),t.on("change",function(t){_ed.setModified(!1),e.type=$(this).val(),_ed.enableScheduleControls()}),t.selectpicker("refresh"),n=this.InitStandardDatePicker("#schedule-end",e.end,function(t){e.end=t}),t=this.InitBoolSelect("#schedule-enabled",e.enabled,SWIUtil.tr("Yes"),SWIUtil.tr("No"),function(t){e.enabled=t}),n=this.InitStandardInput("#schedule-interval",e.interval,function(t){e.interval=t},!0),t=$("#schedule-weekdays"),t.unbind("change"),t.empty(),$.each(_ed._report.weekdays,function(n,o){t.append(SWIUtil.GetOption(n,o,$.inArray(n,e.weekdays)!=-1?n:""))}),t.multipleSelect({filter:!0,maxHeight:130,allSelected:SWIUtil.tr("All selected"),countSelected:SWIUtil.tr("# of % selected"),selectAllText:SWIUtil.tr("Select all")}),t.on("change",function(t){_ed.setModified(!1),e.weekdays=$(this).val()}),t=$("#schedule-months"),t.unbind("change"),t.empty(),$.each(_ed._report.months,function(n,o){n<12&&t.append(SWIUtil.GetOption(n,o,$.inArray(n,e.months)!=-1?n:""))}),t.multipleSelect({filter:!0,maxHeight:130,allSelected:SWIUtil.tr("All selected"),countSelected:SWIUtil.tr("# of % selected"),selectAllText:SWIUtil.tr("Select all")}),t.on("change",function(t){_ed.setModified(!1),e.months=$(this).val()}),t=$("#schedule-days"),t.unbind("change"),t.empty();for(var a=1;a<=32;a++)t.append(SWIUtil.GetOption(a.toString(),32==a?"Last":a.toString(),$.inArray(a,e.days)!=-1?a.toString():""));t.multipleSelect({filter:!0,maxHeight:130,allSelected:SWIUtil.tr("All selected"),countSelected:SWIUtil.tr("# of % selected"),selectAllText:SWIUtil.tr("Select all")}),t.on("change",function(t){_ed.setModified(!1),e.days=$(this).val()});var r=this.InitStandardInput("#schedule-repeat1",e.repeat1,function(t){e.repeat1=t}),i=$("#schedule-repeat1-dropdown");i.empty(),i.append($("<li><a href='#'>"+SWIUtil.tr("None")+"</a></li>")),i.append($("<li><a>5 "+SWIUtil.tr("minutes")+"</a></li>")),i.append($("<li><a>10 "+SWIUtil.tr("minutes")+"</a></li>")),i.append($("<li><a>30 "+SWIUtil.tr("minutes")+"</a></li>")),i.append($("<li><a>1 "+SWIUtil.tr("hour")+"</a></li>")),i.append($("<li><a>6 "+SWIUtil.tr("hours")+"</a></li>")),$("#schedule-repeat1-dropdown > li > a").unbind("click").on("click",function(){_ed.setModified(!0),r.val($(this).text()),e.repeat1=$(this).text()});var l=this.InitStandardInput("#schedule-repeat2",e.repeat2,function(t){e.repeat2=t});i=$("#schedule-repeat2-dropdown"),i.empty(),i.append($("<li><a href='#'>"+SWIUtil.tr("Indefinitely")+"</a></li>")),i.append($("<li><a>15 "+SWIUtil.tr("minutes")+"</a></li>")),i.append($("<li><a>30 "+SWIUtil.tr("minutes")+"</a></li>")),i.append($("<li><a>1 "+SWIUtil.tr("hour")+"</a></li>")),i.append($("<li><a>12 "+SWIUtil.tr("hours")+"</a></li>")),i.append($("<li><a>1 "+SWIUtil.tr("day")+"</a></li>")),$("#schedule-repeat2-dropdown > li > a").unbind("click").on("click",function(){_ed.setModified(!0),l.val($(this).text()),e.repeat2=$(this).text()}),_ed.enableScheduleControls()},e.prototype.initDragPanels=function(){$(".drag-panel").find(".element-btn-group").remove();for(var e=0;e<_ed._report.els.length;e++){var t=_ed._report.els[e],n=_ed.createButtonGroup(null,t);0==t.position?$("#page-panel").append(n.Group):1==t.position?$("#row-panel").append(n.Group):2==t.position?$("#col-panel").append(n.Group):3==t.position?$("#data-panel").append(n.Group):10==t.position&&$("#restriction-panel").append(n.Group),0!=t.position&&2!=t.position||$pivotMode.hasClass("active")||_ed.setPivotMode(!0)}$(".drag-panel").on("click",function(e){_ed.hidePanels()}),$(".drag-panel").on("dragenter",function(e){$(this).addClass("over")}),$(".drag-panel").on("dragover",function(e){return e.preventDefault&&e.preventDefault(),!1}),$(".drag-panel").on("dragleave",function(e){$(this).removeClass("over")}),$(".btn-group").on("dragenter",function(e){$(this).children(".element-btn").addClass("over2")}),$(".btn-group").on("dragleave",function(e){$(this).children(".element-btn").removeClass("over2")}),$(".btn-group").on("dragend",function(e){$(this).children(".element-btn").removeClass("over2")}),$(".btn-group").on("dragover",function(e){return e.preventDefault&&e.preventDefault(),!1}),$(".drag-panel, .jstree").on("drop",function(e){var t=$(this).attr("id");if($(this).removeClass("over"),$(".panel-properties").hide(),e.stopPropagation&&e.stopPropagation(),!_ed._dragTreeSource||"elements-tree"!=t){var n=null;_ed.setModified(!1);var o=$(".over2").first().parent();if(0==o.length?o=null:_ed._dragPanelSource&&o[0]==_ed._dragPanelSource.Group[0]&&(o=null),$(".element-btn").removeClass("over2"),_ed._dragTreeSource){var i=_ed.GetMetaColumn(_ed._dragTreeSource.attr("id"));n=_ed.createButtonGroup(i,null),o?n.Group.insertBefore(o):$(this).append(n.Group),2==n.Element.type?(n.Element.aggr=2,n.Element.totalsaggr=2):1!=n.Element.type&&(n.Element.aggr=4,n.Element.totalsaggr=4),_ed._dragTreeSource=null,_ed._dragPanelSource=null}if(_ed._dragPanelSource)if("elements-tree"==t)_ed._dragPanelSource.Group.remove();else if("restriction-panel"==t){if(10!=_ed._dragPanelSource.Element.position){var i=_ed.GetMetaColumn(_ed._dragPanelSource.Element.metaguid);n=_ed.createButtonGroup(i,null),$(this).append(n.Group),_ed._dragTreeSource=null,_ed._dragPanelSource=null}}else _ed._dragPanelSource.Group!=o&&(o?_ed._dragPanelSource.Group.insertBefore(o):$(this).append(_ed._dragPanelSource.Group),n=_ed._dragPanelSource,_ed._dragTreeSource=null,_ed._dragPanelSource=null);if(n){var a=n.Element;"page-panel"==t?a.position=0:"row-panel"==t?a.position=1:"col-panel"==t?a.position=2:"data-panel"==t?a.position=3:"restriction-panel"==t&&(a.position=10),"row-panel"==t||"col-panel"==t||"page-panel"==t?2==n.Element.type&&2==n.Element.aggr?n.Element.name=n.Element.name.replace(SWIUtil.tr("Maximum of")+" ",""):1!=n.Element.type&&4==n.Element.aggr&&(n.Element.name=n.Element.name.replace(SWIUtil.tr("Count of")+" ","")):"data-panel"==t&&(2==n.Element.type&&2==n.Element.aggr?n.Element.name=SWIUtil.tr("Maximum of")+" "+n.Element.name:1!=n.Element.type&&4==n.Element.aggr&&(n.Element.name=SWIUtil.tr("Count of")+" "+n.Element.name)),n.Redraw()}return _ed.enableControls(),!1}}),$(".drag-panel").on("dragend",function(e){$(".drag-panel").removeClass("over")})},e.prototype.CreateOptionCheckbox=function(e,t,n){var o=$("<div>").addClass("form-group col-sm-offset-2 col-sm-10 checkbox"),i=$("<label>");o.append(i);var a=$("<input type='checkbox'>").prop("checked",t);return i.append(a),i.append($("<span>").html(e)),a.unbind("change").on("click",function(e){_ed.setModified(!1),n(a.is(":checked"))}),o},e.prototype.InitStandardInput=function(e,t,n,o){var i=$(e);return i.val(t),i.unbind("input").on("input",function(e){_ed.setModified(!0),o&&(this.value=this.value.replace(/[^0-9\.]/g,"")),n($(this).val())}),i},e.prototype.InitStandardDatePicker=function(e,t,n){var o=$(e);return o.val(t),o.unbind("keyup change input").on("keyup change input",function(e){_ed.setModified(!0),n($(this).val())}),o.unbind("blur").on("blur",function(e){var t=$(this).val();t.length>0&&t.length<12&&$(this).val(t+" 00:00:00"),n($(this).val())}),o.datepicker({constrainInput:!1}),setDatePickerDefaults(),o},e.prototype.InitBoolSelect=function(e,t,n,o,i){var a=$(e),r=t?"1":"0";return a.unbind("change"),a.selectpicker("destroy"),a.empty(),a.append(SWIUtil.GetOption("0",o,r)),a.append(SWIUtil.GetOption("1",n,r)),a.on("change",function(e){_ed.setModified(!1),i("1"==$(this).val())}),a.selectpicker("refresh"),a},e}(),SWIProperties;!function(e){function t(e,t,o){$elementDropDown.hide();var i=e.Group.parent().attr("id"),a=e.Element;if(a){var r=10==a.position;$("#properties-title").text(a.name);var l=$("#property-name");l.val(a.name),l.unbind("input").on("input",function(t){_ed.setModified(!0),a.name=$(this).val(),e.Redraw()});var p=$("#property-name-dropdown");p.empty(),p.append($("<li><a href='#'>"+a.metaname+"</a></li>")),a.metaname!=a.name&&p.append($("<li><a>"+a.name+"</a></li>")),$("#property-name-dropdown > li > a").unbind("click").on("click",function(){_ed.setModified(!0),l.val($(this).text()),a.name=$(this).text(),e.Redraw()});var d=null,s=$("#properties-sort-group");if(r)s.hide();else{s.show(),d=$("#property-sort").clone(),s.children(".properties-value").empty().append(d),d.empty(),d.append(SWIUtil.GetOption("Not sorted",SWIUtil.tr("Not sorted"),a.sort)),d.append(SWIUtil.GetOption("Automatic Ascendant",SWIUtil.tr("Automatic ascendant"),a.sort)),d.append(SWIUtil.GetOption("Automatic Descendant",SWIUtil.tr("Automatic descendant"),a.sort));for(var c=0;c<t.els.length;c++)d.append(SWIUtil.GetOption((c+1).toString()+" Ascendant",(c+1).toString()+" "+SWIUtil.tr("Ascendant"),a.sort)),d.append(SWIUtil.GetOption((c+1).toString()+" Descendant",(c+1).toString()+" "+SWIUtil.tr("Descendant"),a.sort));d.selectpicker("refresh"),d.on("change",function(e){_ed.setModified(!1),a.sort=$(this).val()})}s=$("#properties-format-group"),r||e.Column.enums||1!=a.type&&2!=a.type?s.hide():(d=$("#property-format").clone(),d.empty(),s.children(".properties-value").empty().append(d),s.show(),1==a.type||1!=a.type&&3==a.position&&4==a.aggr?(d.append(SWIUtil.GetOption("Default",SWIUtil.tr("Default"),a.format)),d.append(SWIUtil.GetOption("General",SWIUtil.tr("General"),a.format)),d.append(SWIUtil.GetOption("Numeric0",SWIUtil.tr("Number"),a.format)),d.append(SWIUtil.GetOption("Numeric1",SWIUtil.tr("Number 1 dec."),a.format)),d.append(SWIUtil.GetOption("Numeric2",SWIUtil.tr("Number 2 dec."),a.format)),d.append(SWIUtil.GetOption("Numeric3",SWIUtil.tr("Number 3 dec."),a.format)),d.append(SWIUtil.GetOption("Numeric4",SWIUtil.tr("Number 4 dec."),a.format)),d.append(SWIUtil.GetOption("Decimal0",SWIUtil.tr("Decimal"),a.format)),d.append(SWIUtil.GetOption("Decimal1",SWIUtil.tr("1 Decimal"),a.format)),d.append(SWIUtil.GetOption("Decimal2",SWIUtil.tr("2 Decimals"),a.format)),d.append(SWIUtil.GetOption("Decimal3",SWIUtil.tr("3 Decimals"),a.format)),d.append(SWIUtil.GetOption("Decimal4",SWIUtil.tr("4 Decimals"),a.format)),d.selectpicker("refresh")):2==a.type&&(s.show(),d.append(SWIUtil.GetOption("Default",SWIUtil.tr("Default"),a.format)),d.append(SWIUtil.GetOption("ShortDate",SWIUtil.tr("Short date"),a.format)),d.append(SWIUtil.GetOption("LongDate",SWIUtil.tr("Long date"),a.format)),d.append(SWIUtil.GetOption("ShortDateTime",SWIUtil.tr("General date short time"),a.format)),d.append(SWIUtil.GetOption("LongDateTime",SWIUtil.tr("General date long time"),a.format)),d.selectpicker("refresh")),d.on("change",function(e){_ed.setModified(!0),a.format=$(this).val()})),s=$("#properties-serie-group"),"row-panel"==i||"col-panel"==i?(d=$("#property-serie").clone(),s.children(".properties-value").empty().append(d),s.show(),0==d.children("option").length?(d.append(SWIUtil.GetOption("0",SWIUtil.tr("None"),a.serie)),d.append(SWIUtil.GetOption("2",SWIUtil.tr("Axis"),a.serie,"fa fa-long-arrow-right")),d.append(SWIUtil.GetOption("3",SWIUtil.tr("Splitter"),a.serie,"fa fa-ellipsis-h"))):d.val(a.serie).change(),d.on("change",function(t){_ed.setModified(!1),a.serie=$(this).val(),e.Redraw()}),d.selectpicker("refresh")):s.hide(),s=$("#properties-chart-group"),"data-panel"==i?(d=$("#property-chart").clone(),s.children(".properties-value").empty().append(d),s.show(),0==d.children("option").length?(d.append(SWIUtil.GetOption("-1",SWIUtil.tr("None"),a.chart)),d.append(SWIUtil.GetOption("0",SWIUtil.tr("Point"),a.chart,"fa fa-line-chart")),d.append(SWIUtil.GetOption("1",SWIUtil.tr("Pie"),a.chart,"fa fa-pie-chart")),d.append(SWIUtil.GetOption("2",SWIUtil.tr("Line"),a.chart,"fa fa-line-chart")),d.append(SWIUtil.GetOption("3",SWIUtil.tr("Bar"),a.chart,"fa fa-bar-chart")),d.append(SWIUtil.GetOption("4",SWIUtil.tr("Stacked Area"),a.chart,"fa fa-area-chart")),d.append(SWIUtil.GetOption("5",SWIUtil.tr("Horizontal Bar"),a.chart,"fa fa-line-chart")),d.selectpicker("refresh")):d.val(a.chart),d.on("change",function(t){_ed.setModified(!1),a.chart=$(this).val(),e.Redraw()}),d.selectpicker("refresh")):s.hide(),s=$("#properties-aggregate-group"),"data-panel"==i?(d=$("#property-aggregate").clone(),s.children(".properties-value").empty().append(d),s.show(),0==d.children("option").length?(d.append(SWIUtil.GetOption("0",SWIUtil.tr("Sum"),a.aggr)),d.append(SWIUtil.GetOption("1",SWIUtil.tr("Minimum"),a.aggr)),d.append(SWIUtil.GetOption("2",SWIUtil.tr("Maximum"),a.aggr)),d.append(SWIUtil.GetOption("3",SWIUtil.tr("Average"),a.aggr)),d.append(SWIUtil.GetOption("4",SWIUtil.tr("Count"),a.aggr))):d.val(a.aggr).change(),d.on("change",function(e){_ed.setModified(!1),a.aggr=$(this).val()}),d.selectpicker("refresh")):s.hide(),s=$("#properties-totals-group"),"data-panel"==i?(d=$("#property-totals").clone(),s.children(".properties-value").empty().append(d),s.show(),0==d.children("option").length?(d.append(SWIUtil.GetOption("0",SWIUtil.tr("No total"),a.totals)),d.append(SWIUtil.GetOption("1",SWIUtil.tr("For rows"),a.totals)),d.append(SWIUtil.GetOption("2",SWIUtil.tr("For columns"),a.totals)),d.append(SWIUtil.GetOption("3",SWIUtil.tr("For rows and columns"),a.totals))):d.val(a.totals).change(),d.on("change",function(e){_ed.setModified(!1),a.totals=$(this).val()}),d.selectpicker("refresh")):s.hide(),s=$("#properties-totalsaggr-group"),"data-panel"==i?(d=$("#property-totalsaggr").clone(),s.children(".properties-value").empty().append(d),s.show(),0==d.children("option").length?(d.append(SWIUtil.GetOption("0",SWIUtil.tr("Sum"),a.totalsaggr)),d.append(SWIUtil.GetOption("1",SWIUtil.tr("Minimum"),a.totalsaggr)),d.append(SWIUtil.GetOption("2",SWIUtil.tr("Maximum"),a.totalsaggr)),d.append(SWIUtil.GetOption("3",SWIUtil.tr("Average"),a.totalsaggr)),d.append(SWIUtil.GetOption("4",SWIUtil.tr("Count"),a.totalsaggr))):d.val(a.totalsaggr).change(),d.on("change",function(e){_ed.setModified(!1),a.totalsaggr=$(this).val()}),d.selectpicker("refresh")):s.hide(),s=$("#properties-operator-group"),r?(d=$("#property-operator").clone(),s.children(".properties-value").empty().append(d),s.show(),d.empty(),d.append(SWIUtil.GetOption("0",SWIUtil.tr("Equals"),a.oper)),d.append(SWIUtil.GetOption("1",SWIUtil.tr("Is different from"),a.oper)),e.Column.enums||(d.append(SWIUtil.GetOption("2",SWIUtil.tr("Is greater than"),a.oper)),d.append(SWIUtil.GetOption("3",SWIUtil.tr("Is greater or equal than"),a.oper)),d.append(SWIUtil.GetOption("4",SWIUtil.tr("Is smaller than"),a.oper)),d.append(SWIUtil.GetOption("5",SWIUtil.tr("Is smaller or equal than"),a.oper)),d.append(SWIUtil.GetOption("6",SWIUtil.tr("Is between"),a.oper)),d.append(SWIUtil.GetOption("7",SWIUtil.tr("IS not between"),a.oper))),1!=a.type||e.Column.enums||(d.append(SWIUtil.GetOption("8",SWIUtil.tr("Contains"),a.oper)),d.append(SWIUtil.GetOption("9",SWIUtil.tr("Does not contain"),a.oper)),d.append(SWIUtil.GetOption("10",SWIUtil.tr("Starts with"),a.oper)),d.append(SWIUtil.GetOption("11",SWIUtil.tr("Ends with"),a.oper)),d.append(SWIUtil.GetOption("12",SWIUtil.tr("Is empty"),a.oper)),d.append(SWIUtil.GetOption("13",SWIUtil.tr("Is not empty"),a.oper))),d.append(SWIUtil.GetOption("14",SWIUtil.tr("Is not Null"),a.oper)),d.append(SWIUtil.GetOption("15",SWIUtil.tr("Is Null"),a.oper)),d.on("change",function(t){_ed.setModified(!1),a.oper=$(this).val(),e.Redraw()}),d.selectpicker("refresh")):s.hide(),s=$("#properties-prompt-group"),r?(d=$("#property-prompt").clone(),s.children(".properties-value").empty().append(d),s.show(),0==d.children("option").length?(d.append(SWIUtil.GetOption("0",SWIUtil.tr("No prompt"),a.prompt)),d.append(SWIUtil.GetOption("1",SWIUtil.tr("Prompt at execution"),a.prompt,"fa fa-hand-o-right")),d.append(SWIUtil.GetOption("2",SWIUtil.tr("Prompt only one value"),a.prompt,"fa fa-hand-o-right"))):d.val(a.prompt).change(),d.on("change",function(t){_ed.setModified(!1),a.prompt=$(this).val(),e.Redraw()}),d.selectpicker("refresh")):s.hide(),s=$("#properties-required-group"),r?(d=$("#property-required").clone(),s.children(".properties-value").empty().append(d),s.show(),0==d.children("option").length?(d.append(SWIUtil.GetOption("0",SWIUtil.tr("No"),a.required)),d.append(SWIUtil.GetOption("1",SWIUtil.tr("Yes"),a.required))):d.val(a.required).change(),d.on("change",function(e){_ed.setModified(!1),a.required=$(this).val()}),d.selectpicker("refresh")):s.hide(),n("val1",e,a.val1,function(e){a.val1=e}),n("val2",e,a.val2,function(e){a.val2=e}),n("val3",e,a.val3,function(e){a.val3=e}),n("val4",e,a.val4,function(e){a.val4=e}),s=$("#properties-evals-group"),r&&e.Column.enums?(d=$("#property-evals").clone(),s.children(".properties-value").empty().append(d),s.show(),d.empty(),$.each(e.Column.enums,function(e,t){d.append(SWIUtil.GetOption(t.id,t.val,$.inArray(t.id,a.evals)!=-1?t.id:""))}),d.multipleSelect({filter:!0,maxHeight:130,isOpen:!0,keepOpen:!0,allSelected:SWIUtil.tr("All selected"),countSelected:SWIUtil.tr("# of % selected"),selectAllText:SWIUtil.tr("Select all")}),s.height(330),$(".ms-choice").css("cursor","default").off("onClick").off("click"),$(".ms-choice").off("onClick").off("click"),d.on("change",function(t){_ed.setModified(!1),a.evals=$(this).val(),e.Redraw()})):s.hide(),e.Redraw(),$propertiesPanel.css({position:"fixed","z-index":"10000",left:o.pageX-315,top:o.pageY-(r?180:60)}).show(),$("#properties-panel-close").on("click",function(e){$propertiesPanel.hide()})}}function n(e,t,n,o){var i=$("#properties-"+e+"-group"),a=!1;if(i.children(".properties-value").empty(),10!=t.Element.position||t.Column.enums)i.hide();else{i.show();var r=$("<input id='property-"+e+"' type= 'text' class='form-control'>");if(r.val(n),r.removeClass("numeric datepicker"),1==t.Element.type)a=!0,r.addClass("numeric"),i.children(".properties-value").append(r);else if(2==t.Element.type){var l=$("<div style='display:table;position:relative;'>");i.children(".properties-value").append(l),l.append(r);var p=$("<div class='input-group-btn'>");p.append($("<button class='btn btn-default dropdown-toggle' type='button' data-toggle='dropdown'><span class='caret'></span></button>"));var d=$("<ul class='dropdown-menu'>");p.append(d),l.append(p),r.addClass("datepicker"),d.empty(),$.each(availableDateKeywords,function(e,t){d.append($("<li><a href='#'>"+t+"</a></li>"))}),d.find("a").unbind("click").on("click",function(){_ed.setModified(!0),r.val($(this).text()),o($(this).text()),t.Redraw()}),r.datepicker({constrainInput:!1,dateFormat:"dd.mm.yy"})}else i.children(".properties-value").append(r);r.unbind("change keyup blur input").on("change keyup blur input",function(e){_ed.setModified(!0),a&&(this.value=this.value.replace(/[^0-9\.]/g,"")),o($(this).val()),t.Redraw()})}}e.ShowPropertiesPanel=t}(SWIProperties||(SWIProperties={}));