@using Seal.Model;
@{
    ReportTask task = Model;

    task.TemplateDescription = "Load a table into the current database. If set, the task Input Object can be used as the SQL Select Statement.";

    //Parameters for this task
    task.Parameters.Add(new Parameter() { Name = "source_name", Value = "", DisplayName = "Data Source Name", Description = "The name of the DataSource used to perfrom the SQL Select Statement." });
    task.Parameters.Add(new Parameter() { Name = "sql", Value = "", DisplayName = "SQL Select Statement", Description = "The Select SQL Statement used to load the table from the source." });
    task.Parameters.Add(new Parameter() { Name = "table_name", Value = "", DisplayName = "Destination table name", Description = "The name of the destination table created in the database. If empty, the name of the tab is used." });
    task.Parameters.Add(new Parameter() { Name = "sql_source_check", Value = "", DisplayName = "Source SQL Check Select", Description = "Optional SQL Select Statement to load a Check table from the source connection. If both source and destination Check tables are identicals, the table is not loaded." });
    task.Parameters.Add(new Parameter() { Name = "sql_dest_check", Value = "", DisplayName = "Destination SQL Check Select", Description = "Optional SQL Select Statement to load a Check table from current source. If both source and destination Check tables are identicals, the table is not loaded." });

    task.Script = @"@using System.IO
@{
    ReportTask task = Model;
    var helper = new TaskHelper(task);    

    var input = task.ExecInput as string; //use input if any
    var sql = input;
    if (string.IsNullOrEmpty(sql)) {
        sql = task.GetValue(""sql"");
    }

    helper.LoadTableFromDataSource(
        task.GetValue(""source_name""), 
        sql, 
        task.GetValue(""table_name""), 
        task.ExecuteForEachConnection, 
        task.GetValue(""sql_source_check""), 
        task.GetValue(""sql_dest_check"")
    );
}
";

    task.BodyScript = ReportTask.BodyScriptTemplate;
}
